<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Memory Game</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: #f4f4f9;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      /* Navbar */
      #navbar {
        width: 100%;
        background: #2196f3;
        color: white;
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 10px 0;
        flex-wrap: wrap;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }
      #navbar input,
      #navbar select,
      #navbar button {
        padding: 5px;
        border-radius: 5px;
        border: none;
        font-size: 14px;
      }
      #navbar div {
        margin: 5px;
        font-size: 16px;
      }
      /* Board */
      #board {
        display: grid;
        gap: 10px;
        justify-content: center;
        margin: 20px auto;
        max-width: 100%;
      }
      .card {
        width: 70px;
        height: 70px;
        background: #4caf50;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        cursor: pointer;
        color: transparent;
        border-radius: 10px;
        transition: transform 0.5s, background 0.3s, color 0.3s;
        transform-style: preserve-3d;
        user-select: none;
      }
      .card.flipped {
        background: #fff;
        color: #000;
        cursor: default;
        transform: rotateY(180deg);
      }
      .card.matched {
        background: #2196f3;
        color: #fff;
        cursor: default;
        transform: rotateY(180deg);
      }
      @media (max-width: 400px) {
        .card {
          width: 60px;
          height: 60px;
          font-size: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div id="navbar">
      <div>
        Player: <input type="text" id="player-name" placeholder="Your name" />
      </div>
      <div>
        Level:
        <select id="level">
          <option value="easy">Easy (8 Pairs)</option>
          <option value="medium">Medium (12 Pairs)</option>
          <option value="hard">Hard (16 Pairs)</option>
        </select>
      </div>
      <div>
        Theme:
        <select id="theme">
          <option value="fruits">Fruits</option>
          <option value="animals">Animals</option>
          <option value="emoji">Emoji</option>
        </select>
      </div>
      <div id="moves">Moves: 0</div>
      <div id="score">Score: 0</div>
      <div id="timer">Time: 0s</div>
      <button id="restart">Restart</button>
    </div>

    <div id="board"></div>

    <!-- Winning sound -->
    <audio
      id="win-sound"
      src="https://freesound.org/data/previews/341/341695_6268366-lq.mp3"
    ></audio>

    <script>
      const board = document.getElementById("board");
      const movesEl = document.getElementById("moves");
      const scoreEl = document.getElementById("score");
      const timerEl = document.getElementById("timer");
      const levelSelect = document.getElementById("level");
      const themeSelect = document.getElementById("theme");
      const restartBtn = document.getElementById("restart");
      const winSound = document.getElementById("win-sound");

      let cards = [],
        firstCard,
        secondCard;
      let lockBoard = false,
        matchedPairs = 0;
      let moves = 0,
        score = 0,
        time = 0,
        timerInterval = null;
      let gameStarted = false;

      const symbolPool = {
        fruits: [
          "ðŸŽ",
          "ðŸŒ",
          "ðŸ‡",
          "ðŸŠ",
          "ðŸ‰",
          "ðŸ“",
          "ðŸ",
          "ðŸ¥­",
          "ðŸ¥",
          "ðŸ’",
          "ðŸ",
          "ðŸ¥¥",
          "ðŸ‘",
          "ðŸ‹",
          "ðŸ«",
          "ðŸˆ",
        ],
        animals: [
          "ðŸ¶",
          "ðŸ±",
          "ðŸ­",
          "ðŸ¹",
          "ðŸ°",
          "ðŸ¦Š",
          "ðŸ»",
          "ðŸ¼",
          "ðŸ¨",
          "ðŸ¯",
          "ðŸ¦",
          "ðŸ®",
          "ðŸ·",
          "ðŸ¸",
          "ðŸµ",
          "ðŸ”",
        ],
        emoji: [
          "ðŸ˜€",
          "ðŸ˜‚",
          "ðŸ˜",
          "ðŸ˜Ž",
          "ðŸ˜­",
          "ðŸ˜¡",
          "ðŸ¥¶",
          "ðŸ¤¯",
          "ðŸ˜´",
          "ðŸ¥³",
          "ðŸ¤©",
          "ðŸ˜‡",
          "ðŸ˜ˆ",
          "ðŸ¤–",
          "ðŸ‘»",
          "ðŸ’©",
        ],
      };

      const levelPairs = { easy: 8, medium: 12, hard: 16 };

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      function generateCards(level, theme) {
        let pairs = levelPairs[level];
        let chosen = symbolPool[theme].slice(0, pairs);
        return shuffle([...chosen, ...chosen]);
      }

      function startTimer() {
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          time++;
          timerEl.textContent = "Time: " + time + "s";
          updateScore();
        }, 1000);
      }

      function createBoard() {
        const level = levelSelect.value;
        const theme = themeSelect.value;
        cards = generateCards(level, theme);
        matchedPairs = 0;
        moves = 0;
        score = 0;
        time = 0;
        movesEl.textContent = "Moves: 0";
        scoreEl.textContent = "Score: 0";
        timerEl.textContent = "Time: 0s";
        lockBoard = false;
        firstCard = null;
        secondCard = null;
        clearInterval(timerInterval);
        gameStarted = false;

        let cols = levelPairs[level] <= 8 ? 4 : levelPairs[level] <= 12 ? 6 : 8;
        board.style.gridTemplateColumns = `repeat(${cols}, minmax(60px,1fr))`;
        board.innerHTML = "";

        cards.forEach((symbol) => {
          const card = document.createElement("div");
          card.classList.add("card");
          card.dataset.symbol = symbol;
          card.textContent = "";
          card.addEventListener("click", flipCard);
          board.appendChild(card);
        });
      }

      function flipCard() {
        if (!gameStarted) {
          startTimer();
          gameStarted = true;
        }
        if (lockBoard || this === firstCard) return;
        this.classList.add("flipped");
        this.textContent = this.dataset.symbol;
        if (!firstCard) {
          firstCard = this;
          return;
        }
        secondCard = this;
        moves++;
        movesEl.textContent = "Moves: " + moves;
        updateScore();
        checkMatch();
      }

      function checkMatch() {
        if (firstCard.dataset.symbol === secondCard.dataset.symbol) {
          firstCard.classList.add("matched");
          secondCard.classList.add("matched");
          matchedPairs++;
          resetBoard();
          if (matchedPairs === levelPairs[levelSelect.value]) {
            clearInterval(timerInterval);
            winSound.play();
            setTimeout(() => {
              alert(
                `ðŸŽ‰ Congratulations! You completed ${levelSelect.value.toUpperCase()} level!`
              );
            }, 200);
          }
        } else {
          lockBoard = true;
          setTimeout(() => {
            firstCard.classList.remove("flipped");
            secondCard.classList.remove("flipped");
            firstCard.textContent = "";
            secondCard.textContent = "";
            resetBoard();
          }, 1000);
        }
      }

      function resetBoard() {
        [firstCard, secondCard] = [null, null];
        lockBoard = false;
      }

      function updateScore() {
        score = Math.max(0, matchedPairs * 100 - moves * 5 - time * 2);
        scoreEl.textContent = "Score: " + score;
      }

      // Event listeners
      levelSelect.addEventListener("change", createBoard);
      themeSelect.addEventListener("change", createBoard);
      restartBtn.addEventListener("click", createBoard);

      // Start initial board
      createBoard();
    </script>
  </body>
</html>
